{% extends "admin/base_admin.html" %}

{% block subtitle %}Gerenciamento de Usuários{% endblock %}

{% block content %}
<div class="admin-actions">
    <div class="search-container">
        <form method="GET" action="{% url 'admin_usuarios' %}">
            <input type="text" name="search" placeholder="Buscar por nome, email ou CPF..." value="{{ request.GET.search }}">
            <button type="submit" class="search-btn"><i class="fas fa-search"></i></button>
        </form>
    </div>
</div>

<div class="table-container">
    <table class="admin-table">
        <thead>
            <tr>
                <th>Nome</th>
                <th>Email</th>
                <th>Telefone</th>
                <th>CPF</th>
                <th>Data de Nascimento</th>
                <th>Data de Cadastro</th>
                <th>Casas</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for usuario in usuarios %}
            <tr>
                <td>{{ usuario.first_name }} {{ usuario.last_name }}</td>
                <td>{{ usuario.email }}</td>
                <td>{{ usuario.telefone }}</td>
                <td>{{ usuario.cpf }}</td>
                <td>{{ usuario.data_nascimento|date:"d/m/Y" }}</td>
                <td>{{ usuario.date_joined|date:"d/m/Y" }}</td>
                <td>{{ usuario.casas_count }}</td>
                <td>
                    <a href="{% url 'admin_usuario_detalhes' usuario.id %}" class="btn-view">Ver</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="8">Nenhum usuário encontrado.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="pagination">
    <span class="step-links">
        {% if usuarios.has_previous %}
            <a href="?page=1{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}">&laquo; primeira</a>
            <a href="?page={{ usuarios.previous_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}">anterior</a>
        {% endif %}

        <span class="current">
            Página {{ usuarios.number }} de {{ usuarios.paginator.num_pages }}
        </span>

        {% if usuarios.has_next %}
            <a href="?page={{ usuarios.next_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}">próxima</a>
            <a href="?page={{ usuarios.paginator.num_pages }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}">última &raquo;</a>
        {% endif %}
    </span>
</div>
{% endblock %}